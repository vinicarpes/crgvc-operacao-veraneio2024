function main() {
  let url ='https://docs.google.com/spreadsheets/d/1wQ_fwm3d9mJhXeu8gvHwmaRKEeTbjCkHYzS6i9aHG78/edit?resourcekey=&gid=378129164#gid=378129164';
  let planilha = SpreadsheetApp.openByUrl(url);
  let aba = planilha.getSheets()[0];
  let dados = aba.getDataRange().getValues();
  let idPastaMae = '11p8a6wAJ6agGpVYGXm7_vaVNMwo6zOw8';
  let pastaMae = DriveApp.getFolderById(idPastaMae);//pasta raiz 
  let pastaFilha = pastaMae.getFolders(); //armazena as pastas dos postos

  let linkFoto;
  let idFoto;
  let foto;
  let posto;
  let data;

  for(let i=1; i<dados.length;i++){
      linkFoto = dados[i][5];
      idFoto = extrairIdArquivo(linkFoto);
      foto = DriveApp.getFileById(idFoto);
      posto = dados[i][2];
      data = dados[i][3];
      
      foto.setName(posto + " " + data + " " + dados[i][4] + " ");
      Logger.log("Foto 1  da linha " + i + " renomeada com sucesso");  

      // foto.moveTo(getPastaMes(extrairMes(data), posto));
      // Logger.log("Foto 2 armazenada com sucesso");
  }

   for(let i=1; i<dados.length;i++){
    if(dados[i][9] != ""){
      linkFoto = dados[i][9];
      idFoto = extrairIdArquivo(linkFoto);
      foto = DriveApp.getFileById(idFoto);
      posto = dados[i][6];
      data = dados[i][7];
      
      foto.setName(posto + " " + data + " " + dados[i][8] + " ");
      Logger.log("Foto 2  da linha " + i + " renomeada com sucesso");
      
      // foto.moveTo(getPastaMes(extrairMes(data), posto));
      // Logger.log("Foto 2 armazenada com sucesso");
     
    }else{Logger.log("Foto 2 não informada da linha " + i);}

  }

   for(let i=1; i<dados.length;i++){
    if(dados[i][13] != ""){
      linkFoto = dados[i][13];
      idFoto = extrairIdArquivo(linkFoto);
      foto = DriveApp.getFileById(idFoto);
      posto = dados[i][10];
      data = dados[i][11];
      
      foto.setName(posto + " " + data + " " + dados[i][12] + " ");
      Logger.log("Foto 3  da linha " + i + " renomeada com sucesso");

      // foto.moveTo(getPastaMes(extrairMes(data), posto));
      // Logger.log("Foto 3 armazenada com sucesso");
      
    }else{
      Logger.log("Foto 3 não informada da linha " + i);
    }

  }
 
}

function getPastaMes(nomeMes, posto){
  let idPastaMae = '11p8a6wAJ6agGpVYGXm7_vaVNMwo6zOw8';
  let pastaMae = DriveApp.getFolderById(idPastaMae);//pasta raiz 
  let pastaFilha = pastaMae.getFolders(); //armazena as pastas dos postos

  let pastaDestino = pastaFilha.getFoldersByName(posto);//precisa pegar dentro de pasta filha a pasta com o nome da variavel posto
  let pastaMes = pastaDestino.getFoldersByName(nomeMes);//dentro da pasta destino, deve pegar a pasta com o nome da variavel nomeMes
  
  return pastaMes;
}

function extrairMes(dataString){
  // let dataArray = dataString.split('/');
  // let dia = parseInt(dataArray[0],10);
  // let mes = parseInt(dataArray[1],10) - 1;
  // let ano = parseInt(dataArray[2], 10)

  // data = new Date(ano, mes, dia)

  const nomesMeses = [
    'Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho',
    'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'
  ];

  let nomeMes = nomesMeses[dataString.getMonth()];

  Logger.log(nomeMes);  // Exibe o nome do mês no log

  return nomeMes;
}


function extrairIdArquivo(link){

  let match = link.match(/[-\w]{25,}/);

  return match ? match[0] : null;
}
